# ATM模拟系统

## 一、课程认识

### 1.1 目的

ATM管理系统的目的在于模拟银行ATM的常见功能,如账户注册、登录、存款、取款、转账、改密等,并实现一定的用户管理和数据持久化。本报告旨在介绍ATM模拟管理系统的设计与实现。通过这个课程项目，我们将深入了解C语言的应用，并通过实践掌握软件开发过程中的基本原理和技能。该课程旨在培养学生的编程能力、系统设计能力以及解决实际问题的能力。

### 1.2 性质

本课程是一门实践性较强的课程，要求学生结合理论知识和实际应用，通过设计和实现ATM管理系统，掌握软件开发的流程和方法。通过此项目，学生将运用C语言进行软件开发，了解与实际工程开发相结合的软件设计方法。本课程属于应用型课程,要求学生熟练掌握C语言的基本语法和常用函数,并能运用所学知识开发一个完整的，实用的程序项目。

### 1.3 任务

#### 1.3.1 基本要求

(1) 实现用户注册、登录功能

(2) 实现账户余额查询、存款、取款、转账功能

(3) 实现密码修改功能

(4) 实现简单的数据持久化,保存用户数据到二进制文件

(5) 实现简单的用户管理功能,如用户删除

(6) 实现验证码和密码加密功能,提高系统安全性

(7) 实现用户交易记录和银行终总额查询功能

(8) 实现超限提醒和账户冻结功能

#### 1.3.2 扩展要求

(1) 实现定期邮件提醒用户余额和近期交易情况

(2) 实现账户注销功能

(3) 实现可视化图形化界面

(4) 增加更丰富的管理员功能

(5) 增加管理员的查，删，找功能

(6)增加管理员的解封，限额，查看交易记录等功能

## 二、课题选择

### 2.1 课题背景

随着科技的发展和社会的进步，ATM（自动取款机）已经成为了现代金融领域中不可或缺的一部分。ATM的普及和应用方便了人们的日常生活，使得金融交易更加便捷和高效。然而，随之而来的是ATM管理的复杂性和挑战性。为了确保ATM系统的安全性、可靠性和高效性，需要一个有效的管理系统来监控和控制ATM的运作。如今，ATM自动提款机系统已经广泛应用于各大银行,方便了人们的财务管理和交易。

本课题拟基于C语言开发一个ATM管理系统,实现ATM的常见功能,加深对C语言的理解运用。

### 2.2 意义

(1)熟练掌握C语言的基本语法和常用函数。通过开发一个完整的ATM管理系统项目,可以深入理解C语言各种数据类型、运算符、控制流语句、函数、指针、结构体等概念。

(2)锻炼编程思维和代码实现能力。实现ATM各项功能需要思考界面设计、程序流程和算法,编写清晰的代码。这有助于培养分析问题和编程解决问题的能力。

(3)加深对ATM工作原理的理解。开发ATM管理系统可以加深对ATM机理、交易流程和安全机制，用户认证、账户管理的理解。

(4)实现简单的数据持久化。利用文件操作将用户数据保存到文件,可以理解文件的读写原理。

(5)实际应用的意义。一个高效、安全的ATM管理系统可以提升金融机构的运营效率，减少人力资源的消耗。同时，它还能够提供可靠的账户管理和交易记录，增强用户对于金融机构的信任度，促进金融行业的发展。

### 2.3 实用性

(1)模拟真实ATM机的使用场景和流程,对新手更加友好。可以作为C语言入门的学习项目。

(2)数据存储使用简单文件操作,没有复杂的数据库,易于理解和修改。可以作为文件操作的示例程序。

(3)具有登录验证、账户管理、存取款转账、改密等基本功能,涵盖常用的结构体、函数、文件操作使用示例。可以作为C语言语法的综合练习项目。

(4)有一定的扩展性,可以加入更多功能、优化界面和数据存储、支持多用户等来丰富项目。

(5)ATM管理系统在实际应用中具有广泛的实用性。它可以用于各类金融机构，包括银行、信用社、金融公司等，用于管理和监控他们的ATM网络。通过该系统，机构可以方便地进行账户管理、交易监控、故障排查等操作，提高运营效率和服务质量。

(6)ATM管理系统还可以为用户提供更便捷的金融服务。用户可以通过ATM机进行存款、取款、查询余额等操作，而管理系统可以实时更新用户账户信息，确保交易的准确性和安全性。因此，该系统的实用性不仅体现在金融机构内部管理方面，也直接关系到用户的金融体验和便利性。

## 三、系统总体分析与设计

### 3.1系统总体框架图

如下图所示:

![](http://www.plantuml.com/plantuml/svg/fPR1Jjj048RlVWeVuS0Bs5B5grHgK94eXvBUtLOAk10bRPpMKUs6e49p08UALgYa9Y_ZsVM-HSSQjLtosmKr5_3Ep7x_ZtPcnEPU-_7pzejdEuv7FmFwSkWxdewcwk2wx2NK7UhXaKbFV6TxorrJLrFg7AsxxQUjNJx5itN7TRro4T77Jteqftn8RyRbwzolmiKYfOkuM4pKoraLsDXuvDfWC_dEOAUrizTorwX_Lh4g4G4jYJ1Fxagsuacr6f_gvB38H-OaXJjyoyxBhJk2lp7iL9tV8g12ICwNWDHN5KnGuO2wbyNDPnKFQFz2TJCa20Ch__9Qkq-sj_W4vYnxlVUrzWGkMG7-jyLcasWJZ5goPNvUVZjh5f6yW5UossmOBODfb8z-qApJB8RzV2_MRb3pAjFPLyJR0dQbBO0IA78rDL7GZ1S1gLf28npn9WXe_mRm8A3d0vMEGG1U0g8GmmYUyIJVzbVZse6_sjFPHFSxz3RcFZ3lJfSN3JSjzQxvZLHODuWUXrd3jtVAmJ57wdUAvAGQh5WzMGiGX6G50H3iG9cIChl4vMf1iTP_sFoKsQtECpFgunw-8s3N-Ii_CnZor8TZamJu6B8gL1Ye99Hsa4ckVvwcQdmmIq8AgJFdCVWN7Ehgi3X-V_eJgJXzzqt6WoP4IkJd9l_YVn9-0G00)

### 3.2 简要功能说明

一个简化版的银行管理系统。主要功能包括用户的注册、登录、存款、取款、转账、改密、查询余额、打印交易凭据等操作。代码中使用了结构体数组来存储用户信息，包括账号、密码、余额、交易记录等字段。同时，还提供了管理员系统，管理员可以查看所有用户信息、删除账户、冻结账户、设置限额等功能。

### 3.3 功能模块

1. 注册账号:用于注册系统的新用户,要输入账号、密码、验证码等信息。
2. 登录系统:输入账号和密码,并校验验证码登录系统。登录成功后可以进行各种交易操作和信息查询。
3. 查看余额:查看登录用户的账户余额信息。
4. 存款:向登录用户的账户进行存款操作。需要输入存款金额,可以选择是否打印存款凭据。
5. 取款:从登录用户的账户进行取款操作。需要输入取款金额,可以选择是否打印取款凭据。
6. 转账:从登录用户的账户向其他用户账户进行转账操作。需要输入转账金额和目标用户账号,可以选择是否打印转账凭据。
7. 打印交易凭据：用进行交易时，可以打印交易的金额，类型，时间。
8. 改密:修改登录用户的密码。需要输入原密码和新的密码。
9. 查看交易记录:查看最近20条登录用户的交易记录,包括交易时间、交易类型、交易金额等信息。
10. 登出:退出当前登录用户,返回到系统主界面。
11. 管理员系统，需要密钥登录
    1. 查询所有用户
    2. 修改用户信息
    3. 查询指定用户
    4. 冻结/解冻用户账号
    5. 删除指定用户
    6. 查看指定用户交易记录
    7. 退出管理员，回到用户界面
    8. 查看银行总余额
    9. 修改指定用户限额

整个系统使用结构体、文件操作、验证码、加密显示等技术,实现了一个基本的ATM管理系统。

### 3.4 开发环境

`vscode`、`neovim`

## 四、模块详细设计

### 4.1 加密输入模块

加密输入模块主要实现输入用户密码，管理员密钥时，在终端只显示 `*`号，增强管理系统的安全性，输入后可以存放到字符数组中。加强系统安全性。

![](http://www.plantuml.com/plantuml/svg/SoWkIImgAStDuG8pkAoUTinzkhpxQSyqXKnR0skkejI2rCGIBWK5gnTzsv_sJtkwTlhpDSiKags1Gfbf2Xh92izch7ywOTdpjPrFTlKfgCSKgMigb6IavYbe02KqWQg0Mf_ldlnixlod-rOzxriFqfYQKvoge07K1PB7OKuIkZbWavvDNlPovfAddRrFTZGysR4AuXgGaKY6mXK_sJ_twTePC1S_xTXG_6pgXkUxMwnX2Z8LNhIlUhfe7bpWMUVafxqR5BIUzc-76fgNafd61QMXWQ5Gdf6P0xIgfAWqLHCORFa5N0v0UM0O0W00)

1. 程序开始处使用关键字"start"表示程序的起始点。
2. 初始化变量i为0，用于记录字符在数组中的索引位置。
3. 进入一个循环，循环条件为"repeat while (true)"，表示一直执行循环直到遇到终止条件。
4. 在循环中，首先获取一个字符c。
5. 使用条件判断语句"if"检查字符c是否等于回车符'\r'。
6. 如果字符c等于回车符，则执行":结束循环"操作，即跳出循环。
7. 如果字符c不等于回车符，则进入下一个条件判断语句。
8. 使用条件判断语句"if"检查字符c是否等于退格符'\b'。
9. 如果字符c等于退格符，则执行":擦除前一个字符"操作，即删除数组中的前一个字符。
10. 如果字符c不等于退格符，则执行":保存字符c到s数组"操作，即将字符c保存到一个名为s的数组中。
11. 执行":i 自增"操作，将变量i的值加1，用于指向下一个字符在数组中的位置。
12. 执行":打印 *号"操作，即输出一个星号。
13. 结束条件判断语句。
14. 回到步骤4，继续下一次循环，读取下一个字符并重复以上操作。
15. 当遇到回车符时，跳出循环。
16. 程序结束，使用关键字"stop"表示程序的结束点。

### 4.2 验证码模块

验证码模块通过 `time.h`库文件的调用，实现了生成随机四位的验证码，用户在登录和注册时需要验证。加强系统安全性。

![](http://www.plantuml.com/plantuml/svg/SoWkIImgAStDuG8pkAoUJvd_h6F2ordzp-RiUZPrm_FblK_NJh3cAaejI4qiuL800gkd-rOzxrjlycpDGckm05IFmTEE3SQcJtPslvo-vVci5hWH44MPQGeQJpkMF9ks5YxnRCRwfnEMFTtG_sHNdw61fa99HcgUWWPGL1Ei0ybeeEAdQwS3qVCroo36fUOKfofe0BLZg0MgUhQ-5qLjNafc6iIbJ_RFVRfs1aGXq8qGLJ3VAPHdPEO0JONux_dkoS_cpjVaidgsVVVJhWKGfKzsR8A8WxKLb-GNS3a0ZGU67m00)

1. 开始：程序开始执行。
2. 生成随机数种子：生成一个随机数种子，用于生成伪随机数序列。
3. 重复循环：进行以下步骤4次。
4. 生成0到35之间的随机数：生成一个介于0到35之间的随机数。
5. 判断随机数是否小于10：判断上一步生成的随机数是否小于10。
6. 如果是：执行以下步骤。
7. 生成数字字符：生成一个数字字符。
8. 否则：执行以下步骤。
9. 生成字母字符：生成一个字母字符。
10. 保存生成的字符：将生成的数字字符或字母字符保存起来。
11. 循环结束：判断是否完成了4次循环。
12. 如果循环未结束，则回到步骤4继续执行。
13. 添加字符串结束符：在生成的字符序列末尾添加一个字符串结束符。
14. 停止：程序执行结束。

### 4.3 队列加密模块

运用数据结构中的队列对密码进行加密，管理员查看用户密码时只可看到加密后的密码，增强了安全性。

加密原理如下表所示：

| q[0] | q[1] | q[2] | q[3] | q[4] | q[5] | q[6] | q[7] | q[8] | q[9] | q[10] | q[11] |
| :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :---: | :---: |
|  0  |  6  |  3  |  1  |  7  |  5  |  8  |  9  |  2  |  4  |      |      |
|      | head |      |      |      |      |      |      |      |      | tail |      |
|  0  |  6  |  3  |  1  |  7  |  5  |  8  |  9  |  2  |  4  |      |      |
|      |      | head |      |      |      |      |      |      |      | tail |      |
|  0  |  6  |  3  |  1  |  7  |  5  |  8  |  9  |  2  |  4  |   3   |      |
|      |      | head |      |      |      |      |      |      |      |      | tail |
|  0  |  6  |  3  |  1  |  7  |  5  |  8  |  9  |  2  |  4  |   3   |      |
|      |      |      | head |      |      |      |      |      |      |      | tail |

### 4.4 打印凭据模块

在用户进行转账，存款，取款后，可以选择答应交易凭据，增强了代码的实用性

![](http://www.plantuml.com/plantuml/svg/SoWkIImgAStDuG8pkAnUz6r_sZ_jwTx9JpjxdqtVzdBw5cikgwSRsY3i5tlNFEjTz6J7hcTprZoTim6c83DDGUDfnv9dqzO-cxlmoUvjLWfFTYrvDcFoyusxdyxhrbGeoKZD0wfOE-FPcdsQN0eALY_MxNk-Tnso8g2P47bhaFoppibFUpSyRL_xh7UTDLTgJd6g0f5sz4_3QmTGdc8xW860rmwWF6uxmA9pLZsVlnHP5r0kBoKp3HW9-GLS3a0sC4O0)

1. 开始。
2. 获取当前时间。
3. 将时间转换为本地时间。
4. 如果判断条件指示交易类型为存款，则执行以下步骤：
   - 设置交易类型为存款。
   - 打印凭据。
5. 否则，如果判断条件指示交易类型为取款，则执行以下步骤：
   - 设置交易类型为取款。
   - 打印凭据。
6. 否则，如果判断条件指示交易类型为转款，则执行以下步骤：
   - 设置交易类型为转款。
   - 打印凭据。
7. 否则，执行以下步骤：
   - 未知交易类型。
8. 停止。

### 4.5 删除模块

#### 4.5.1 交易记录更新

删除模块的本质是一种伪删除，将某个数组删除，整体向前，永远保持最近的20条记录。

![](http://www.plantuml.com/plantuml/svg/SoWkIImgAStDuG8pk3BJ53IUJrdnh6ExNwZlyxMTJtRrFPlJy7J9ygSDU-mr5KeoKlCKD9xDMA_9fQ1WzRHZmSkPIvwlMVDaHyEJ7QkUjZO_txB06YopeUrPPyEpEPqGiQSJ9Zxjx7s-VFVJhXKGjK_szZxVkmwYjht_wOQ98EjcjG1jiUPApIbELT1uEc4Ps98dEtgVTIv_iR3doUxTJ_PEVJQvzydUEK15UIcPQK17vnTmEG3PG1y00000)

1. 开始：代码执行的起点。
2. 判断用户NUM是否等于最大值。
3. 如果用户NUM等于最大值：
   - 删除第一个元素：删除数据中的第一个元素。
   - 将所有元素向前移动一个位置：将数据中的所有元素往前移动一个位置，覆盖删除的第一个元素。
   - 减少NUM的值：将NUM的值减少一个。
4. 如果用户NUM不等于最大值，则不执行任何操作。
5. 停止：代码执行结束。

#### 4.5.2 删除账号

管理员系统中，查找到相应的账号后进行删除，本质也是伪删除。

![](http://www.plantuml.com/plantuml/svg/SoWkIImgAStDuG8pk3BJ53IUpLZ_TCAoPvtxddPiU3vxnzFMpK_sBtpMkDvUKw4a8pLFGQCojLYJIq71wkc6jkTJLZphs0wHVzgnuENC9TP06OGf4B5d7HEUTir7rmyquSd-kK_NpdWshVt9xctM4A5dC_OzNx9B2LcZeX98BZMdE5L18ozV4ukwfqisljYo5AekBoKpZGkX6g7ssPnLcBvIV3PzmRFDKo7cW4o0w2ykoI_WSW2oWM430000)

1. 开始。
2. 检查是否找到相关信息。
   - 如果是，执行以下操作：
     - 将用户信息删除。
     - 检查是否删除成功。
       - 如果删除成功，执行以下操作：
         - 保存文件。
         - 显示"删除成功!"。
       - 如果删除失败，执行以下操作：
         - 显示"删除失败!"。
   - 如果不是，执行以下操作：
     - 显示"未找到相关信息!无法删除!"。
3. 停止。

### 4.6 判断强密码模块

当用户注册账号时，需要一个同时包含大写字母，小写字母，以及数字强密码，用此函数做判断，增加安全性。

![](http://www.plantuml.com/plantuml/svg/fPJTRX9H4CVlprFC9LogDuQQjEzXkC1uI8d8DkmsnhkbQP66Zw9jiNvOcaZ1L96jDsveBG_JdRFRAr_1EOoo1yHAqoiEcV_i_pTpPiwAxMIAplhJl1WVH2gwsCMjOnoKmwEIlIGAbYCXBxEEu43uTfDZWJ_4_klmIpVmlzcNxeQGXSUWrKBaif2mINYrFy9Xzy7z93YhiW29WfKK02dEvs3Wrx7JNX80jcEj2Pct9IIUIvk5bG_OgsAjzSYodgXzBppRrCeO2I2EX7kVWc43AntLwhC3rhQm-Pauc3CyFSF3gYO5Y5crpSL9s1YeZwvg7ySbpJfTkSt0F-4uQzd5_gz1KQx9ZFu4UKMDxxZJmX-xk5tdBEqpxGJ0gfWbyFlaOcQnoxGFW6wygL870seEdPVv2YQj7REeenVHLu_kaJMCppYpG03ebNMl7zv9pqrZ7fFe3ruk-qysz7Qm_8R-ga7zUa9JkHZdtVJSvDlGTdeBqhBo9hJtqcRo3Mbvlk3PQYul8H6D3jJxxS2l1hux6TZb90cvA5wDyo4j7mMmMOcw9NMwyNT5gMYqX-yEgN9ISzgyMJLtZIVYqYsPBSTNDREcd-SrqtTsa4rhS8hhSkp9hmC0lmy5QuemyEkBGPBGjDOabEIzLErcsFlTxCasNmkMpH3851dVnWhzq5lw2m00)

1. 这段代码实现了一个密码强度检查的逻辑。它接受一个密码作为输入，并根据一定的规则判断密码是否符合强密码的要求。
2. 代码开始处使用了一个起始符号，表示程序的开始。
3. 然后，代码会检查输入的密码的长度。如果密码长度小于8个字符，就会输出"密码长度不够"并停止程序。如果密码长度大于等于8个字符，则会执行后续步骤。
4. 接下来，代码会初始化一个名为"book"的数组，用于记录密码中包含的字符类型。这里使用了一个便签来解释数组的作用。
5. 然后，代码会进入一个循环，逐个检查密码的字符类型。
6. 在循环中，代码会获取当前字符，并根据字符的特征判断它是数字、小写字母还是大写字母，并相应地将"book"数组中对应的位置标记为相应的字符类型。这里也使用了便签来解释每个条件判断的作用。
7. 循环会一直执行，直到检查完密码中的所有字符。
8. 在循环结束后，代码会判断密码的强度是否符合要求。如果"book"数组中标记了数字、小写字母和大写字母类型，即密码包含这三种字符类型，那么就会输出"是强密码"并停止程序，同时返回true。如果"book"数组中有某种类型的字符标记缺失，即密码不符合要求，那么就会输出"不是强密码"并停止程序，同时返回false。
9. 这段代码通过逐个检查密码中的字符类型，并使用一个数组来记录字符类型的出现情况，以判断密码是否符合强密码要求。

### 4.7 可视化模块

用于在 `cmd`中尽可能设计一点可视化界面，使得程序更逼真

#### 4.7.1 延迟函数

通过延迟函数，模拟ATM加载的过程。

![](https://www.plantuml.com/plantuml/svg/SoWkIImgAStDuG8pkAoUhflrP6VdqztRNkoV_xHzxxEf6wovCjCKD9wkdVvypR8dEpOzsR7snVuPp-PqGaIUJfXkhwbGaf6Qfw3nRCPwJIu51QjddPEVzcw0o5k312366HeOF5k_-ldoITPSgJd5gK0p9om3gIykoI_WIirBoKpZAaejI4qi0MbvsJ3fwQ9vpxSiUhfdAiWC4js0nHMOxW29ehW4uXOW0zar2kKPcJcfK9Evm0eSWFB0C0C0)

1. 开始：程序开始执行。
2. 定义延迟函数：定义了一个函数，用于延迟一段时间后执行下一步操作。
3. 打印字符：检查字符串中是否还有字符，如果有，则打印当前字符。
4. 延迟100毫秒：等待100毫秒，以便字符能够逐渐打印出来。
5. 递增索引：增加索引，以便获取下一个字符。
6. 重复步骤3-5：重复执行步骤3至5，直到字符串中没有剩余字符为止。
7. 停止：程序结束执行。

#### 4.7.2 清空函数

设置清空函数，对后续的账号锁定，选择菜单等有重要作用。
核心代码如下：

```c
    printf("\r\033[K");
    fflush(stdout);
```

#### 4.7.3 特色菜单模块

使用一种全新的特色菜单界面，用户通过 `h`左移，`l`左移，`a`确认。增加一定的趣味性和真实性。

![](http://www.plantuml.com/plantuml/svg/lPBFIlj04CVl-nHpQ_9h2pyz9aJwAh5kJ31DIf8YGWyUBBHYpA7-GIb8eRP5j1KB9b2gBvDDrhTmR9ielGhE8Pby9z_P-R1JSJtLyHeraomJ8l5f62_Uquinw08BXsB955Wm4qkgaFOdV38G8UdwyQ8d4o8r_osZAHE9jLzHZAFZE7fWmJGTpTdfEBqzIMVpT7x7WnxpBsLog1ic1S5p6bG4mmN1jEswI00aVXwou0gFJTeXV-korhsCig61KDKLfM0MHF1qQe7W6FkwzsLPLQr63NPWQpih7r5tLSIUSUGddH7ldsKJ0mOrNOesE_yBEnIBSlQLHAsFcm5wlfLEb_dFoCVxu_HnkAa_NQCOHo_kkhsrPsWaU_z4q7C4aseR18e2_tz5K2x_0O6Q4rHjIpESscg2NOUg1xa1d-jRnamak5PsdLGmnntx1000)

1. 开始：程序开始执行。
2. 提示用户使用"h"（向左移动）、"l"（向右移动）和"a"（确认）操作。
3. 绘制菜单界面。
4. 进入循环，不断执行以下步骤：
5. 获取用户输入。
6. 如果用户输入为"l"（向右移动）：
7. 如果当前位置（num）大于12，则不执行任何操作。
8. 如果当前位置（num）小于等于12：
9. 增加当前位置（num）的值。
10. 清除当前行的内容。
11. 打印制表符。
12. 打印字符串s。
13. 如果用户输入为"h"（向左移动）：
14. 如果当前位置（num）等于0，则不执行任何操作。
15. 如果当前位置（num）不等于0：
16. 减少当前位置（num）的值。
17. 清除当前行的内容。
18. 打印制表符。
19. 打印字符串s。
20. 如果用户输入为"a"（确认)，则跳出循环。
21. 结束循环。
22. 停止程序执行。

#### 4.6.4 换色模块

用新色调代替一贯的白字黑框界面

```c
    //换色，模拟进入了系统
    system("color f6");
```

#### 4.6.7 密码错误锁定模块

可以动态显示密码错误锁定后的剩余时间。

![](http://www.plantuml.com/plantuml/svg/RLB1Jkf05DtFLymITkzjwK9-1UCG6X4DBN4B2mGqM4G8O8Ac2gA9j90GD23bPtfdshzmfgM4gNRHtkcvvvov9pUjwPcYNZhBew10ASzosCQ2-X0cDr3-Lj1bJiqJdA13qrqlarZLS48lbaWIOPoYNrMO6qfG6YqsMh7E6wr_UiuzLCTWN_djiG3LB4w49pfzOQPrbCHwZXIuQDyMEeBUTmHzi8PDbzPRSFsa1C1naMHEUKNo6k4YhTTTFzGCcDtvjQPdT-c7IRipqHzQUTi-6FOX5ZVyPGcZkRSOkrkJLcmbQc3J1ZZLmv449Dr5al8x5R0UOY9-kGtFZo54Uqk_juYWNR2748mcxkgM-_BtFpbhyKY9IzRGU7StWxYBDCT_Dcb7F_S1_iKWXPFWQli9Qas-4R6empurYwBldeKq_Vm2fVcPRzKF)

1. 系统开始运行，并设置初始值。
2. 进入循环，检查条件是否为真（通常是检查用户是否尝试登录）。
3. 清屏并提示用户输入密钥。
4. 如果密钥正确，显示登录成功，并跳出循环。
5. 如果密钥不正确：
6. a. 减少重试次数。
7. b. 如果还有可重试次数，显示登录失败信息，并等待用户输入新的密钥。
8. c. 如果没有可重试次数：
9. 显示锁定信息。
10. 递增锁定时间。
11. 进入内层循环，当锁定时间大于等于0时执行以下步骤：
12. 清屏。
13. 显示剩余锁定时间。
14. 等待1秒。
15. 减少锁定时间。
16. 结束内层循环后，重置重试次数。
17. 继续下一轮循环，直到条件为假（即用户成功登录或达到最大重试次数)。
18. 停止系统运行。

### 4.8 菜单栏模块

#### 4.8.1 普通的用户菜单栏

普通的用户菜单栏引导，操作者可以根据选项进行选择并操作。

![](http://www.plantuml.com/plantuml/svg/lPJ1RjD048Rl-nG-saSungfKk2Dnu0MiPXDRSdOZhosBMq1gC2KbbKYXbOBQ50L2bRefGMqWB7sPpExwn2jWEGXA54S-UUJ3UFN_Cvz6ixlDVClpWuQBiWHL8BfUyBxgzc7_K9nsJLGHupDr-rgy7q8qWTaCReR9csirw3nuyaXEvt9-acfWxrHn3d57H0Sc2ct7nPf-pq18IyEfQNhIUYbUVTQsjZGn7K6xOsY-ZOccFyNCGDgVgBYq7ZHrmynEiClmYbSUpu4VvdeTii4hJeOBVhpEcmb5_tn3zQo3kho1tMYfMhRvsqedT4NCR1e-j5oBx63TkACcLQUMXmWNHsByipJ4AcvIvlZ5yRfloyGB7T-kUbPOc4_60tdGNhyT3Ko2-nks8scruCNtzLurEKk_1R-LlT6l7y_-qJ2VDlCAAZvMNp-MDYpVimYhOQ_mi4Jl6rosI-FRiIrInuyjnaBgLOjJJaT9hrKQfKlhD2X-8PBdiOolIgF33SjnzQQNYuVkrfMVvh0tWcWYBZx8GRpW-vB79lhVLKcElYJlpjFjDvV_OhOBLrqJfPBi5KVRQHOqtDy0)

1. 系统开始，并显示制作菜单栏和欢迎信息，然后加载完成。
2. 进入一个无限循环，直到选择退出。
3. 根据用户的选择进行不同的操作：
4. 如果选择是注册，则执行logup()函数，即用户注册操作。
5. 如果选择是登录，则执行login()函数，即用户登录操作。
6. 如果选择是查余额，则检查是否已登录。如果未登录，则显示提示信息"请先登录"；否则执行showBalance()函数，显示余额。
7. 如果选择是存款，则检查是否已登录。如果未登录，则显示提示信息"请先登录"；否则执行deposit()函数，进行存款操作。
8. 如果选择是取款，则检查是否已登录。如果未登录，则显示提示信息"请先登录"；否则执行withdraw()函数，进行取款操作。
9. 如果选择是管理，则执行menu2()函数，即进入管理菜单操作。
10. 如果选择是退出，则显示"谢谢使用！"，并停止循环。
11. 如果选择是转账，则检查是否已登录。如果未登录，则显示提示信息"请先登录"；否则执行transfer()函数，进行转账操作。
12. 如果选择是改密，则检查是否已登录。如果未登录，则显示提示信息"请先登录"；否则执行changePassword()函数，进行改密操作。
13. 如果选择是注销，则检查是否已登录。如果未登录，则显示提示信息"请先登录"；否则执行logout()函数，进行注销操作。
14. 如果选择是邮箱，则检查是否已登录。如果未登录，则显示提示信息"请先登录"；否则执行email(pr)函数，进行邮件操作。
15. 如果选择是其他任何选项，则显示提示信息"请移动到正确位置"。
16. 在每次循环的末尾，执行防止闪退的操作和清屏操作。
17. 循环继续，等待下一次用户的选择。

#### 4.8.2 管理员菜单栏引导

通过普通界面进入管理员系统，操作者输入密钥后可以进行相应操作。

![](http://www.plantuml.com/plantuml/svg/hLFBRjD05DtxAxA49M-eD_qL95gfKWg8f7jRK6EdTMn8Wrnm5IVD8ppgM2gYhKEId_6zC_uBnhbAx46rikagC_Syvfo9PxjMV_ckVh1VLPOBPGl-QZ0w0lDFClEvuuFTni1HbItqvgmVuwyUNpIJHHVrYHWoNsVjGVf-3AQ1BLj8136uGJiaQJApsIn4QyIxn-pRDSGdn5ALlTtAlI8dkOuVt5SgbTKvbeQ-nNyFqRnQdRPJhUtS8dkubF5v2mu7VAY36QIdVVRrWn23SwLc8CreKEhpIFP95Y6Ut4W-cOXsSE61Fyu4Qmb-YTPa-7mC4uC5kagCP74c5EG8RbFmg5C6Psd4JzxS_u7M7Cmekw_3omBnzQkztRBmZ-Nms1dmIO_oe9c7ptPoU3fKkkWY08r0DA4oTvVsoJ9jgcdmCMPXbxa6VFBOvPHDEwL_pzFoXk1iRfZ4VVHQF8nWrhwx8i-eY6v3qoX-id8Stli9XYZNaXBHIBhpLBFmw3jw4t27V7GEaPxRaI5DqNIXqI6tjLyHobrN1JOKULvyUzeqxPrjU7Kl2eBqrFrFa6DiD8N66Cm8ByvPDoGzEgw0L8KYrUfltYhROdsmN_q7)

### 4.9 交易模块

#### 4.9.1 邮箱函数

用户登录后可查看邮箱，获得交易的记录信息和剩余余额，方便用户查看钱的走向。

![](http://www.plantuml.com/plantuml/svg/SoWkIImgAStDuG8pkAoUTinzkhpxQS-qf_jMFUzR_sBTmcTJDpoTkSAQo-f5t_Qd_TEUJrdnh6FxarrBdisO_6BTXgTxfm8Ll6plLq1JyQod_UMa3g3Wiyx9JtitFEkVy7p9hYVx5pvhNA-WzAnfnOlz4v_DcVzyLilpDMiodw-P0Z7noOvTLafmJSYsM7CLfHQa9fPmAIXOFLqqxsdN0dGNWcKwbZoRjlRPZFLF9onxiM_VquuDc2w5cQHGdf6PawgWaQbWe-0Nwgl9XTEjG5U-sB8CwAaN-sSyczE9S214zCdUcIyNpLMm1ePXVW6NGsfU2Z100G00)

#### 4.9.2 查找交易记录函数

管理员可以指定账号并且打印最近20条记录，5个一行打印。

![](http://www.plantuml.com/plantuml/svg/SoWkIImgAStDuG8pkAoUTinzkhpxQS-q5-iMFfkwuUdC5TPSLiyw9p_jtV2iTz6BXJtFrom3Yhnix7tQr_PYtOQdUwS2bJtVtMBDfQ00LGWHVjhQ_7pB0h3mqqNpddOjW9kea9nVcbS2aibCKz1uDcFzqmdBditfVB9hofCTgpGLIZ9IynGqAbEBDRaKW033Tg1eQavnge96NZvKnVFTov_lNWjn4rWwBoKp3UYZ_08k1o0Rw3q0)

1. 初始化变量i和count。
   打印记录标题。
   将计数器count设置为0。
   然后，使用repeat关键字表示一个循环块。在循环中，以下操作会被重复执行，直到满足循环条件不再成立：
2. 打印s->record[i]，其中s是一个对象，表示某个记录，record是s的属性，[i]表示索引为i的元素。
   增加计数器count的值。
   使用if语句检查计数器count是否是5的倍数。
   如果是5的倍数，则执行以下操作：
   打印换行符。
   如果不是5的倍数，则执行以下操作：
   继续打印当前行。
   循环结束后，代码执行以下操作：
3. 打印换行符。
   使用stop关键字表示流程的结束。

### 4.10 注销模块

用户可以自行销户，但是需要输入密码

![](http://www.plantuml.com/plantuml/svg/SoWkIImgAStDuG8pkAoURLxnSah3i-aBdcsU-cpIagUpvxtVq_DY_VPdhNqlstjVD3I_c3bHKL7H6gXonlgd4vP1rDjhHEhxQLfPSsMcAMYys3VvQUlI9pjsHMegb6IavYbe09LgSYaeM07DWKW-NT_sV46ZbJL8yEKgeFcD416G0CW82E_PsiNF5wwpHpC5gELfnuANCvUysBBiMSTsa9RKdE9K1GsWQw3o4ErFTlH2J00hoKl9JEC2AqHnen_4TBXkg-Uxbp_VlVRPvDudU-TOGpHeW89ZQWT43rWHie0r5yJiufBy0Yu781iOcW00)

1. 开始：程序开始执行。
2. 显示提示信息：“注销无法撤回，请慎重考虑!!!”。
3. 提示用户输入是否要注销账户，用户可以输入Y（是）或N（否）。
4. 如果用户输入为Y（是），则执行以下步骤：
5. 提示用户输入密码。
6. 验证密码是否正确。
7. 如果密码正确，则删除账户。
8. 如果密码不正确，则显示提示信息：“密码不正确”。
9. 如果用户输入为N（否），则显示提示信息：“继续操作”。
10. 如果用户输入既不是Y（是）也不是N（否），则显示提示信息：“无效输入”。
11. 停止：程序结束执行。
12. 目的是实现一个简单的注销账户流程，首先确认用户是否希望注销账户，然后验证密码并删除账户（如果密码正确），或者继续其他操作（如果密码不正确或用户选择不注销账户）。对于无效输入，程序会给出相应的提示信息。

### 4.11 限额模块

管理员可以设置指定用户的单次额度

![](https://www.plantuml.com/plantuml/svg/SoWkIImgAStDuG8pkAnUx9lyj7NfopaDBvOrlfmvuUMYkSzdjRpOiknf_tPhhimq1Ord4-OytxBe-Ux9p-RDiRNLDTHKACb8pGEAprYloQMWOFLipgfddVkUTcnuFdl7qzRDJ_OlVDQuNj4QB3MhwMdZdEThEv_kQuNOOysLcbESgg3nTC8oiEON6vgVJrdnj7tliwaRhC42VTkVzaz3jXCi3D4DTDpJNSl00a_sptswTWP4068baZ1C83Kl9JCDwD7y0Yu781leQm00)

1. 开始：开始符号表示流程的起点。
2. 输入需要限额的账号：这是一个用户输入步骤，用于获取需要设置限额的账号。
3. 调用searchResult函数：这是一个函数调用步骤，用于搜索并检查是否存在与输入的账号相关的信息。
4. 如果搜索结果等于-1，则执行以下操作：
5. 未找到相关信息：这是一个输出步骤，表示未找到与账号相关的信息。
   暂停等待输入：这是一个暂停步骤，等待用户进行下一步操作。
   否则，如果搜索结果不等于-1，则执行以下操作：
6. 调用searchResult函数：再次调用searchResult函数来获取搜索结果。
   获取搜索结果：这是一个步骤，用于获取与账号相关的搜索结果。
   输入额度：这是一个用户输入步骤，用于输入限额信息。
   保存额度信息：这是一个步骤，用于将输入的额度信息保存。
   保存信息：这是一个步骤，用于保存其他相关信息。
   停止：停止符号表示流程的终点。

### 4.12 冻结模块

用户具有是否被冻结的状态，管理员可以解冻用户

![](http://www.plantuml.com/plantuml/svg/SoWkIImgAStDuG8pkAoUJrdnh6Fxyvcxd-wTQisLcQQWyNHzs_C5ZI-dp7onVlspDGkVJTsWOADWhAbGaf6Qfw3nRCPwJIu51Ik8ZcST4vvspRVcIiqfJWNgdB0CBFTYoxAd_TkVjkr-ldkoDL00REh4hkVpbpvVj_3vXBQd4sUydDFmObdZY-MBWQhGZ0OQWAOOP0R45BWGH2V48ZJzO1EGvI7QuKw4gtcoenUBihoKp3Gk5EKmnHYkWgc6aCKb-GLS3a0sC7G1)

用户登录时如果超过三次密码错误，账号会被冻结，之后用户可以选择是否告诉管理员需要解冻，选择’是‘可以告诉管理员，管理员可以知道你有没有被冻结，需不需要解冻，并且可以选择将你解冻。

### 4.13 注册模块（与组员合作完成）

用户注册账户功能，以及对用户信息的保存和初始化。

![](http://www.plantuml.com/plantuml/svg/ZPDHRjD048RVVGe_9bT87-XLWjYg4Q5KYIjUuuhMLYcAKTDYIuIq9RXM1N4Wo4KkJIxZ6QzlmTW3tNeXKlCGZVR_PkUJFTxiM-sUjVUYQrI5qS9F0vnynaK4XyVoHmZ36poT5yuG_HYyK2O7SkNWXm5Chuh00pTvic5qjip6VuAcQMsB7RD1dKt3D5leB_DfYk_FSN7Az-FP_C-8eKVH1b5zw-Mk8RfzKNR8vGaSr5nAf0LVVTYF-03SEVdbjw_Bf1BXuvlltAPRt7jed39W1ohOWduziIlQLbLgKX0VvkSsT_5uFe5VAQHXzlEjJ1R_6ZomO5o6DdxRVwZ0qnMTZoReUiNriOnjDL7ft2TSbBboKk4ea76i2sbA6bspqhsq9bA4eudgK9ApPNuteqUEBhsnCLozoUw2udAy5igF4XpOQ-CidQ9_WbykwDslXSY3k4VTL3Zlo8Rtjeuwrt3vCHz5XCfPEGw2g4Pagp7j8nFPwWBjk5p9CoUxhTtqj2VQpzL3t7dMsJBqclVCVBNTwGgpOVNsHDFuc_D_jPcRLDC7-ni0)

1. 开始。
2. 检查注册账号数量是否超过最大限制。
3. 如果超过最大限制，则显示无法注册新账号的提示，停止注册流程。
4. 如果没有超过最大限制，则输入注册账号。
5. 将账号存储到数组中。
6. 检查账号是否已经注册过。
7. 如果账号已注册，则显示账号已注册的提示，停止注册流程。
8. 如果账号未注册过，则重复以下步骤：
   - 输入注册密码。
   - 如果密码强度不足，则显示密码要求的提示。
   - 否则，生成验证码并输入进行验证。
   - 如果验证码错误，则显示验证码错误的提示。
   - 如果验证码验证成功，则显示验证成功的提示，并进行以下操作：
     - 设置账户的初始余额。
     - 设置账户的状态。
     - 设置账户的交易次数。
     - 设置账户的提交状态。
     - 设置账户的交易金额限制。
     - 自增用户计数器。
     - 保存用户信息到文件。
     - 结束循环。
9. 停止。

### 4.14 登录模块（与组员合作完成）

用户登录功能，并进行一系列后续的操作

![](http://www.plantuml.com/plantuml/svg/VLJDRjD04BxlKvXR-WhneNsL8bmr8XHK1o5kzQ59A77ZaXGIL1GYIa6HuaM0YAc9-pAUNVl4Ap1aPDMU-ESGERFVp7pppUVTiplxnvtdJzfYyoAQIJI2qy_9pniOhapHX6YXpsNgk73UnQ3gO_35OQjj6GqAggk53aVgmsntnsZPHkEbPUy80v_MWT6WCZ3udPwwUDuvj8vo28RgXbYe34LFKqqYVNrBO5Xz9_pVFuD4hX9dh7-4sfzhhmiNamScpvJWtJ3GRXv4H11NrfvJmEQgxy7PZ5KqInA6NdnxJLJZkxbof0wd5GbMsqPLaMXbOvmKXcVgtQ_wUQsZHws3GiJkF7qcYdr8HzmUaMDQamj0TlL7XucfnpESFbsWxixMQMQDx9HUui1DJzudTptkaPAUB9NAyqNTWyRJHCfgqp01MHwP9-svYRna6cP2vNgfvISzzylhFposzXzJXPfDK6IZqPRtIEkwJuNDegSXh2_9Y6Q9cdwarxuQzD8tVVm5xmBM8tZbqaTC2MKMOTCJBLmWCQjaGpWcgthxZPPQvq_wLtnhwl2B3fTqmyJ1wpWuYOD5HXrnLLUG48LhuZ_lvGIklkOtROhDh7jO1k-zVm00)

1. 用户开始操作，输入账号。
2. 开始循环遍历账户列表。
3. 如果当前账户与输入的账号匹配，则进入判断账号冻结的条件。
4. 如果账号已冻结，则显示账号已冻结的提示信息，并询问用户是否联系管理员。
5. 如果用户选择联系管理员，则显示已成功联系管理员，并提交冻结信息给管理员。
6. 如果用户选择不联系管理员，则显示请及时联系管理员的提示信息。
7. 结束程序。
8. 如果账号未冻结，则要求用户输入密码，并生成验证码。
9. 进入验证码验证的循环，直到验证码验证通过或用户选择退出。
10. 如果验证码错误，则显示验证码错误的提示信息，让用户重新输入。
11. 如果验证码正确，则跳出验证码验证循环。
12. 进行密码匹配的判断。
13. 如果密码匹配，则显示登录成功的提示信息，并设置指针指向当前账户。
14. 结束程序。
15. 如果密码不匹配，则显示密码错误的提示信息。
16. 继续遍历下一个账户。
17. 如果遍历结束仍未找到匹配的账号，则显示账号不存在的提示信息。
18. 结束程序。

### 4.15 存款，取款，转账模块（部分功能）

存款，取款，转账的**保存，检验记录，打印凭据功能**

![](https://www.plantuml.com/plantuml/svg/SoWkIImgAStDuG8pkAoUpL_wV4xtindhdqvOzcJ7BYC3QowhfsjdF6rQ0MIys3VvQVkkPnqJddRDVzhV-t9P1rnG2QBbvPo65yiQdtLEVjgxuMdxscUzwwmqAlNpDAsKh85czorzDcKRI7thqgThfpzViyoQApDDGQDIKw4a8pKFo4WjrkHI008hP1EikL9pYbCLG2hpO2hpyY4AYqlo2o3I6Y0I8WXtqlG5pwPsGEnJ0fgIbvAPnkK0f83-1G00)

1. 开始执行代码。
2. 检查是否为第20次操作。
3. 调用 `lastRecord(pr)`函数，可能是用来获取上一次操作的记录。
4. 调用 `saveFile(users, count)`函数，可能是用来保存用户信息和计数。
5. 输出"存款/取款/转账成功！"，提示操作成功。
6. 输出"是否需要打印凭据:(y/n):"，询问用户是否需要打印凭据。
7. 从用户输入中读取一个值，存储为变量 `a`。
8. 如果

   `a`等于 `y`或 `Y`，则进入下面的判断分支：

   - 调用 `printReceipt(amount, 1)`函数，可能是用来打印凭据。
9. 如果 `a`等于'n'或'N'，则停止执行代码。
10. 如果以上条件都不满足，则执行下面的操作：

    - 输出"无效输入"，提示用户输入无效。
11. 结束代码的执行。

### 4.16 读取文件模块

![](https://www.plantuml.com/plantuml/svg/SoWkIImgAStDuG8pkAoUTKv-kgVXsRJs9xktMNDbfYbeGDXFryvuEcU5lQP2IKPg7b1mndfDBWK5gnVhTp_jd_Pyoefd7TkVJTtmTEUs5rkxdpRiURvxPd9-QLw9DLTgJd6gWiRJ2SiWwlTDVjg-I-dvx7LFEtkVJLy0qVcqQy7JrgLAra0LnINv1LofUIcPQLmeXZ_Pl_1PutfhBgkdhPjVJbyBTI1GpVufJsVFWpl0cWjiW0FG1A2d0000)

1. 打开文件：这个步骤表示代码正在尝试打开一个文件。
2. 如果文件存在（条件判断），则执行以下步骤：

   - 读取用户数并将其赋值给变量"count"：代码会从文件中读取用户数，并将该值赋给名为"count"的变量。
3. 如果文件不存在（条件判断），则执行以下步骤：

   - 输出"目前无用户加入"：代码会在屏幕上打印出一条消息，表示当前没有任何用户加入。
   - 终止流程（stop）：代码执行到此处会停止运行。
4. 无论文件存在与否，接下来的步骤都会执行：

   - 读取用户信息：代码会读取文件中的用户信息。
   - 关闭文件：代码在完成文件读取后会关闭该文件。
   - 返回用户数：代码会返回用户的数量。

最后，代码会停止运行（stop）。

这段代码的主要功能是检查文件是否存在，如果存在则读取文件中的用户数和用户信息，如果文件不存在则输出一条消息并停止运行。无论文件存在与否，代码都会返回用户数。

## 五、系统实现

### 1. 模块中涉及的主要文件

文件名：`save.bat`

- 本文件主要存放银行用户的信息。
- 对应的结构体为：

  ```cpp
  typedef struct {
      char account[max];     // 账号
      char passwd[max];      // 密码
      double balance;        // 余额
      double record[max];    // 记录，最多保存20条
      int NUM;               // 交易记录数量
      bool Freeze;           // 是否冻结状态
      bool Submit;           // 是否告诉管理员
      double limitCost;      // 限额
  } User;
  ```
- 代码对应的表格如下：

  | 字段名    | 类型     | 说明           |
  | --------- | -------- | -------------- |
  | account   | char[]   | 账号           |
  | passwd    | char[]   | 密码           |
  | balance   | double   | 余额           |
  | record    | double[] | 记录，最多20条 |
  | NUM       | int      | 交易记录数量   |
  | Freeze    | bool     | 是否冻结状态   |
  | Submit    | bool     | 是否告诉管理员 |
  | limitCost | double   | 限额           |

### 2. 主要函数

#### `Code`

**函数声明**

```c
void Code(char* code)
```

****函数功能说明 ** **
该函数用于生成一个随机的四位验证码，验证码由数字和字母组成。

**主要代码段如下 **：

```c
srand(time(NULL)); // 使用当前时间作为随机数生成器的种子
for (int i = 0; i < 4; i++) {
    int r = rand() % 36; // 生成0到35之间的随机数
    if (r < 10) {
        code[i] = '0' + r; // 生成数字字符 '0' 到 '9'
    } else {
        code[i] = 'A' + r - 10; // 生成字母字符 'A' 到 'Z'
    }
}
code[4] = '\0'; // 添加字符串结束符
```

通过时间种子和随机数生成方法实现了生成随机四位验证码的功能。

使用 `srand(time(NULL))`将当前时间作为随机数生成器的种子，确保每次生成的随机数序列都不同。循环执行四次生成四位验证码。最后，在验证码的末尾添加字符串结束符 `\0`，使其成为一个有效的C字符串。

#### `printReceipt`

**函数声明**
`void printReceipt(double amount, int judge)`

****函数功能说明 ** **
该函数用于打印交易凭据，包括交易时间、交易类型和交易金额。

**主要代码段如下 **：

```c
// 获取当前时间
time_t currentTime;
time(&currentTime);

// 将时间转换为本地时间
struct tm* localTime = localtime(&currentTime);

// 使用strftime函数将时间格式化为字符串
char timeString[50];
strftime(timeString, sizeof(timeString), "%Y-%m-%d %H:%M:%S", localTime);

const char *TransType=NULL;

if(judge==1)
    TransType="存款";
if(judge==2)
    TransType="取款";
if(judge==3)
    TransType="转款";

// 打印凭据信息
printf("-------------------------------\n");
printf("        ATM 交易凭据        \n");
printf("-------------------------------\n");
printf("时间: %s\n", timeString);
printf("交易类型: %s\n", TransType);
printf("交易金额: %.2f\n", amount);
printf("-------------------------------\n");
```

通过strftime函数将时间格式化为字符串，将当前时间转换为本地时间，并使用条件语句判断交易类型。根据不同的交易类型，将相应的字符串赋值给TransType。然后使用printf函数打印交易凭据的各项信息，包括分隔线、标题、时间、交易类型和交易金额。最后再打印一条分隔线，完成凭据的打印输出。

#### `lastRecord`

**函数声明**

```c
void lastRecord(User* user)
```

****函数功能说明 ** **
该函数用于保留用户最近的20条交易数据，并删除旧的交易数据。函数接受一个指向用户结构体的指针作为参数。

**主要代码段如下 **：

```c
if (user->NUM == max) 
{
    // 删除第一个元素
    for (int i = 0; i < max-1; i++) 
    {
        user->record[i] = user->record[i + 1];
    }
    user->NUM--;//本质是一种伪删除
}
```

该代码段首先检查用户的交易数据数量是否达到最大值（20条）。如果数量达到最大值，就会执行删除操作。删除操作是通过将第一个元素后面的所有元素向前移动一位来实现的，即将索引大于等于1的元素复制到前一个索引的位置上。最后，将交易数据数量减1，以表示删除了一个旧的交易数据。

通过循环移位的方法实现了只保留最近的20条交易数据。当交易数据数量达到最大值时，即需要删除最旧的一条数据。该方法通过循环将每个元素后面的元素向前移动一位，以实现删除第一个元素的效果。这种实现方法简单高效，并且不需要额外的内存空间。

#### `secret`

**函数声明**
`void secret(char* s)`

****函数功能说明 ** **
此函数用于加密用户输入的字符串，通过将用户输入的字符显示为星号(*)的形式，实现对输入的保密。

**主要代码段如下 **：

```c
int i = 0;
while (1)
{
    char c = getch();  // 读取字符
   
    if (c == '\r')
    {
        s[i] = '\0';
        break;
    }
    else if (c == '\b')
    {
        if (i > 0)
        {
            i--;
            printf("\b \b");  // 擦除前一个字符
        }
    }
    else
    {
        s[i] = c;
        i++;
        printf("*");
    }
}
printf("\n");
```

通过以下方法实现了加密的功能：

- 使用 `getch()` 函数读取用户输入的字符，而不是常规的 `scanf()` 函数，从而在屏幕上不显示用户输入的字符。
- 利用回车键 `\r` 作为输入结束的标志，当用户按下回车键时，将字符串末尾设置为 `\0`，表示字符串的结束。
- 当用户按下退格键 `\b` 时，检查是否已经输入了字符，如果是，则将索引 `i` 减一，并在屏幕上擦除前一个字符的显示。
- 对于其他非特殊字符，将其存储在字符串中，递增索引 `i`，并在屏幕上显示星号 `*` 代替实际字符的显示。

通过以上方法，实现了对用户输入字符串的加密，保护了用户输入的机密信息。

#### `AddSecret`

**函数声明**

```C
void AddSecret(char* s)
```

**函数功能说明 **

该函数用于对密码进行加密。它接受一个字符指针 `s`，表示待加密的密码字符串。

**主要代码段如下 **：

```C
int head=0;                     // 指定首个元素
int tail=strlen(s)+1;           // 字符串的后一个元素

while(head!=tail)
{
    printf("%c",s[head]);       // 打印第一个
    head++;                     // 出队

    s[tail]=s[head];             // 加到队尾
    tail++;

    head++;                     // 出队
}

printf("\n");
```

通过指定首尾索引来实现字符串的循环加密。该算法通过不断出队和将元素加到队尾的操作，对输入的密码字符串进行加密。首先，初始化 `head` 和 `tail` 分别为首个元素和字符串的后一个元素的索引。然后，使用一个循环来遍历字符串的元素。在每次循环中，首先打印并出队第一个元素，然后将出队的元素加到队尾，最后再次出队。通过这样的操作，可以实现对密码字符串的加密。

#### `StrongPasswd`

**函数声明**：

```c
bool StrongPasswd(char *s)
```

**函数功能说明 **：
该函数用于判断给定字符串是否为强密码。强密码的定义是：包含至少一个数字、一个小写字母和一个大写字母。

**主要代码段如下 **：

```c
int book[4] = {0}; // 判断三种类型
for (int i = 0; s[i] != 0; i++) {
    if (isdigit(s[i])) // 如果是数字
        book[1] = 1;
    if (islower(s[i]))
        book[2] = 1;
    if (isupper(s[i]))
        book[3] = 1;
}
if ((book[1] == 1) && (book[2] == 1) && (book[3] == 1))
    return true; // 是强密码
else
    return false; // 不是强密码
```

通过以下方法实现了判断是否为强密码：

- 使用一个长度为4的整型数组 `book`，用于记录数字、小写字母和大写字母是否出现过。
- 遍历给定字符串 `s`，通过 `isdigit()`、`islower()`和 `isupper()`函数判断字符的类型，若是数字、小写字母或大写字母，则将相应的 `book`数组元素置为1。
- 最后，检查 `book`数组的元素是否都为1，如果是，则说明给定字符串包含至少一个数字、一个小写字母和一个大写字母，返回 `true`表示是强密码；否则返回 `false`表示不是强密码。

该方法通过遍历字符串一次，记录字符类型的出现情况，并通过检查记录的结果进行判断，从而判断给定字符串是否为强密码。

#### `printSlowly`

**函数声明**

```c
void printSlowly(const char* str);
```

**函数功能说明 **
该函数用于逐字打印字符串，并在每个字符之间增加延迟，以增加输出的真实感。

**主要代码段如下 **：

```c
for (int i = 0; str[i] != 0; i++)
{
    printf("%c", str[i]);
    Sleep(100);
}
```

在这段代码中，使用 `for`循环逐个遍历字符串 `str`中的字符。通过 `printf`函数将每个字符打印出来。然后使用 `Sleep`函数使程序暂停100毫秒，以实现字符之间的延迟输出。

通过延迟输出字符的方式，实现了逐字打印字符串并增加真实感的效果。在每个字符输出后都暂停一段时间，可以模拟人类逐字阅读的速度，使输出更加逼真。该方法适用于需要在控制台或终端界面逐个显示字符的场景。

#### `clearLine`

**函数声明**

```c
void clearLine();
```

**函数功能说明 **

该函数用于清空当前行，在可视化界面中使用。它通过将光标移动到行首并清除行内容来实现。

**主要代码段如下 **

```c
printf("\r\033[K");
fflush(stdout);
```

通过方法、技巧实现了

该函数通过以下方法和技巧实现了清空当前行的功能：

- 使用转义字符序列 `\r` 将光标移动到行首。
- 使用转义字符序列 `\033[K` 清除行内容。
- 调用 `fflush(stdout)` 刷新标准输出缓冲区，确保立即清空当前行的内容。

这种方法可以在可视化界面中实现清空当前行的效果，使得下一行的输出可以覆盖当前行的内容，从而达到清除当前行的目的。请注意，该方法适用于终端或支持 ANSI 转义序列的环境。

#### `searchResult`

**函数声明**

```c
int searchResult(char* s);
```

**函数功能说明 **

该函数用于在账号数组中查询指定账号的位置。

**主要代码段如下 **：

```c
for (int i = 0; i < count; i++)
{
    if (strcmp(users[i].account, s) == 0)
    {
        return i;
    }
}
return -1;
```

通过遍历账号数组，将每个账号与目标账号进行比较，若相等则返回该账号在数组中的索引位置。如果遍历完整个数组仍未找到匹配的账号，则返回-1表示未找到。

该函数使用了字符串比较函数 `strcmp`来比较账号字符串。如果两个字符串相等，`strcmp`函数返回0，进而判断账号是否匹配。

#### `logup`

**函数声明**：`void logup(int* pp)`

**函数功能说明 **：该函数用于注册新账号，并将注册信息保存到文件中。

**主要代码段如下 **：

```c
if (*pp>MAX)
{
    printf("抱歉，目前系统无法注册新账号");
    return;
}

printf("请输入注册账号:\n");
scanf("%s",users[*pp].account);

if(searchResult(users[*pp].account)!=-1)
{
    printf("该账号已经注册");
    return;
}

while(1)
{
    printf("请输入注册密码:\n");
    secret(users[*pp].passwd);
  
    if(StrongPasswd(users[*pp].passwd)==false)
    {
        printf("请输入含有数字，大写字母，小写字母的强密码\n");
        continue;
    }

    Code(code);
    printf("请输入验证码验证【%s】:\n",code); 
    char ccode[5];
    scanf("%s",ccode);
  
    if(strcmp(code,ccode)!=0)
    {
        printf("验证码错误,请重试!\n");
      
        continue;
    }
    else
        printf("验证成功\n");

    users[*pp].balance=0.0;
    users[*pp].Freeze=false;
    users[*pp].NUM=0;
    users[*pp].Submit=false;
    users[*pp].limitCost=20000;
    (*pp)++;
    saveFile(users, *pp);
    break;
}
```

通过以上代码实现了以下功能：

- 检查注册账号数量是否超过最大限制。
- 接收用户输入的注册账号并检查是否已被注册。
- 要求用户输入符合要求的强密码。
- 生成一个随机验证码并要求用户输入进行验证。
- 将注册信息保存到文件中。

#### `login`

**函数声明**:

```c
void login()
```

**函数功能说明 **:
该函数用于用户登录功能。用户需要输入账号和密码，系统会进行验证。如果账号存在且密码正确，则登录成功，否则根据情况进行相应的处理。

**主要代码段如下 **：

```c

        if (Fridge(users[i].Freeze) == true)//先判断有没有冻结
        {
            // 冻结账号的处理逻辑
            printf("账号已冻结，请联系管理员!\n");
            printf("是否联系管理员(y/n):\n");
            scanf(" %c", &a);
          
            if ((a == 'y') || (a == 'Y'))
            {
              printf("已成功联系管理员\n");
              submit(i); //告诉管理员第几号冻结
            }
            .........
        }
      
        // 验证密码的逻辑
        printf("请输入密码: \n");
        secret(passwd);
        char code[5]; // 存储生成的验证码（包括结束符）

		........
    	Code(code); //生成一个随机验证码
 	 	printf("请输入验证码验证【%s】:\n",code); 
 	  	char ccode[5];
     	scanf("%s",ccode);
        .........
      
        // 密码错误次数超过限制的处理逻辑
        printf("密码重试次数超过限制，账号已冻结，请联系管理员!\n");
        users[i].Freeze=true;//冻结账号
        saveFile(users, count);
        printf("是否联系管理员(y/n):\n");
      
        scanf(" %c", &a);
      
        if ((a == 'y') || (a == 'Y'))
        {
          printf("已成功联系管理员\n");
          submit(i); //告诉管理员第几号冻结
        }
```

通过循环遍历账号列表，逐个对比输入的账号和密码进行验证。通过调用 `Fridge()`函数判断账号是否被冻结，如果是则提示用户联系管理员。如果账号存在且密码正确，则要求用户输入验证码，通过调用 `Code()`函数生成验证码，并与用户输入的验证码进行比较。如果验证通过，则登录成功，将指针 `pr`指向该用户。如果密码错误次数超过限制，则冻结账号并提示用户联系管理员。如果账号不存在，则提示用户重试。

#### `deposit,withdraw,transfer`

**函数声明**

```c
void deposit,withdraw,transfer()
```

**函数功能说明 **

该函数用于实现存款功能。它接受一个指向账户结构体的指针 `pr`，一个指向用户结构体的指针 `users`，以及表示用户数量的整数 `count`。

**主要代码段如下 **：

```c
lastRecord(pr);
saveFile(users, count);
printf("xx成功！\n");

printf("是否需要打印凭据:(y/n):\n");
char a;
scanf(" %c", &a);
if ((a == 'y') || (a == 'Y')) {
    printReceipt(amount, 1);
} else if ((a == 'n') || (a == 'N')) {
    return;
} else {
    printf("无效输入\n");
}
```

通过以下方法、技巧实现了存款功能：

- `lastRecord(pr)`：调用了一个函数 `lastRecord`，该函数用于记录最后一次操作的时间和日期。
- `saveFile(users, count)`：调用了一个函数 `saveFile`，该函数用于将用户数据保存到文件中。
- `printf("存款成功！\n")`：打印提示消息，通知用户存款成功。
- 用户输入是否需要打印凭据，通过使用条件语句进行判断：

#### `timetable`

**函数声明**

```c
void timetable(int a)
```

**函数功能说明 **
该函数用于实现倒计时功能，并在命令行界面显示倒计时的剩余时间。

**主要代码段如下 **：

```c
while(a>=0)
{
    system("cls"); // 清屏
    printf("账号已锁定，还剩%d秒", a);
    Sleep(1000); // 暂停1秒
    a = a - 1;
}
```

这段代码使用了一个 `while`循环，当倒计时时间 `a`大于等于0时，会执行循环体内的操作。在每次循环开始时，使用 `system("cls")`清屏，然后通过 `printf`函数在命令行界面显示当前倒计时的剩余时间。接着使用 `Sleep(1000)`函数暂停1秒，实现每秒更新一次倒计时。最后，将倒计时时间 `a`减1，以进行下一次循环。

通过 `system("cls")`函数清屏和 `printf`函数显示倒计时时间，结合 `Sleep(1000)`函数实现了倒计时功能。这种实现方法简单直观，每秒更新一次倒计时时间并在命令行界面显示。

#### `Delete`

**函数声明**

```c
void Delete(char* s1);
```

**函数功能说明 **

该函数用于删除一个字符串在数组中的匹配项。

**主要代码段如下 **：

```c
int result = searchResult(s1);
if (result == -1) {
    printf("未找到相关信息!无法删除!\n");
    return;
} else {
    for (int i = result; i < count; i++) {
        users[i] = users[i + 1];
    }
    count--;
    printf("删除成功!\n");
}
saveFile(users, count);
```

通过方法、该函数通过以下步骤实现了删除功能：

- 调用 `searchResult()` 函数查找字符串在数组中的索引。
- 如果找不到匹配项（即返回值为 -1），则打印错误信息并返回。
- 如果找到匹配项，从该索引开始，将后面的元素向前移动一位，覆盖匹配项。
- 数组的元素数量减一。
- 打印删除成功的提示信息。
- 调用 `saveFile()` 函数保存更新后的数组到文件中。

#### `printRecord`

**函数声明**

```c
void printRecord(User* s);
```

**函数功能说明 **，该函数用于打印记录。接受一个指向User结构体的指针参数，该结构体包含一个记录数组和记录数量。

**主要代码段如下 **

```c
for (int i = 0; i < s->NUM; i++)
{
    int count=0;
    printf("%.2lf\t",s->record[i]);
    count++;
    if(count%5==0)
    {
        putchar('\n');
    }
}
putchar('\n');
```

通过技巧实现了

该函数通过遍历记录数组并使用printf函数打印每个记录。在每个记录之后，使用计数器count进行计数，每5个记录换行打印。最后，在所有记录打印完毕后，打印一个换行符。

#### `logout`

**函数声明**：

```c
void logout();
```

**函数功能说明 **：
该函数用于实现用户注销账号功能，包括确认注销、验证密码和删除账户等步骤。

**主要代码段如下 **：

```c
printf("注销无法撤回，请慎重考虑!!!\n");
printf("是否注销?(Y/N):\n");
char a;
scanf(" %c", &a);

if ((a == 'y') || (a == 'Y'))
{
    printf("请输入密码:");
    char Old[MAX];
    secret(Old);

    if (strcmp(Old, pr->passwd) != 0)
    {
        printf("密码不正确\n");
        return;
    }

    //删除账户
    Delete(pr->account);
}
........

return;
```

通过以下方法实现了注销账号功能：
用户在函数运行时首先需要确认是否注销账号，输入字符'Y'或'y'表示确认注销，输入字符'N'或'n'表示取消注销。

- 首先，函数会提示用户输入密码，并通过调用 `secret` 函数将用户输入的密码进行隐藏处理。
- 然后，通过比较用户输入的密码与 `pr->passwd` 的值，判断密码是否正确。如果不正确，将输出提示信息并结束函数。
- 如果密码正确，则调用 `Delete` 函数删除当前用户的账户。

#### `limit`

**函数声明**

```c
void limit();
```

**函数功能说明 **

该函数用于设置账号的限额，即对指定账号的消费金额进行限制。

**主要代码段如下 **：

```c
char s1[20];
printf("请输入需要限额的账号:\n");
scanf("%s",s1);
if (searchResult(s1)==-1)
{
    printf("未找到相关信息!\n");
    getchar();
}
else 
{
    int i=searchResult(s1);
    double limitCost2;
    printf("请输入额度:\n");
    scanf("%lf",&limitCost2);
    users[i].limitCost=limitCost2;
    //保存信息
    saveFile(users,count);
}
```

通过以下方法实现了对账号限额的设置：

首先，从用户输入中获取需要限额的账号，并将其存储在字符数组 `s1` 中。接着，通过调用 `searchResult(s1)` 函数来查找账号在用户数组中的索引位置。如果返回值为 `-1`，则表示未找到相关信息，输出提示信息 "未找到相关信息!"。否则，表示找到了对应的账号，继续执行下面的代码。在找到相关信息的情况下，再次调用 `searchResult(s1)` 函数，将返回的索引值赋给变量 `i`。用户被要求输入限额金额，将其存储在 `double` 类型变量 `limitCost2` 中。将 `limitCost2` 的值赋给对应账号在用户数组中的 `limitCost` 字段，实现限额设置。最后，调用 `saveFile(users, count)` 函数保存更新后的用户信息。

#### `menu2`

**函数声明**

```c
void menu2();
```

**函数功能说明 **

该函数是一个管理员系统的菜单，用于管理账户信息和执行不同的操作。函数包含以下功能：

- 显示管理员系统欢迎信息和进入系统提示。
- 设置密钥，并进行密钥验证。
- 当密钥验证成功后，进入管理员系统菜单。
- 管理员系统菜单显示不同的选项，并根据用户的选择执行相应的操作。

**主要代码段如下 **：

**查看冻结账号：**

```c
                int i;

                for (i = 0; i < count; i++) 
                {
                    if (users[i].Freeze) 
                    {
                        printf("编号为%d,账号为%s的用户冻结,是否希望解除冻结(是为1,否为0):%d\n", i, users[i].account,issubmit(i));
                        FriNum++;
                    }
                }
                // ...
```

菜单栏：

```c
void menu2()
{
    // ...

    while (1)
    {
        // ...

        //制作一个可移动的系统菜单
        while(1)
        {
            // ...

            if(ch=='a')
                break;
        }

        // ...

        //选择
        switch (num+1)
        {
            case 1://查看所有账户
                printAllUsers();
                getchar();printf("按回车键继续");
                break;

            case 2://删除账户---因为不准用链表，所以是一种伪删除
                printf("请输入要删除的账号:\n");
                scanf("%s",s1);
                Delete(s1);
                //........
                break;

            case 3://修改账户
                printf("请输入想要修改的账号:\n");
              
                scanf("%s",s1);
                // ...

            case 4://查找账户
                printf("请输入查询的账户:\n");
                scanf("%s",s1);
                // ...

            case 5://退出管理员系统
                return;
                break;

            case 6://交易记录
                printf("请输入查找的账号:\n");
                gets(s1);
                // ...

            case 7:
                //......

            case 8:
                printAll();
                break;

            case 9:
                limit();
                break;

            default:
                //........
                break;
        }
        system("pause");//防闪退
    }
}
```

通过方法、技巧实现了管理员系统菜单的交互和功能选择。在主循环中，用户通过按下不同的键来选择菜单项，并根据选择执行相应的操作。程序使用了嵌套的循环来实现一个可移动的系统菜单，用户可以使用 "h" 键向左移动选项，"l" 键向右移动选项，"a" 键确认选择。

#### ` menu1`

**函数声明**：`void menu()`

**函数功能说明 **：该函数实现了一个模拟银行ATM系统的菜单功能，用户可以通过按键选择不同的操作，包括注册、登录、查余额、存款、取款、管理等功能。

**主要代码段如下 **：

**可视化操作**

```c
 //getch避免缓冲区
            char ch=getch();
            if(ch=='l')
            {
                if(num>12)
                    ;
                else
                {
                num++;
                clearLine();
                for (int i = 0; i < num; i++)
                    printf("\t");
                printf("%s",s); 
                }
   
            }

            if(ch=='h')
            {
                if(num==0)
                    ;
                else
                {
                num--;
                clearLine();
                for (int i = 0; i < num; i++)
                    printf("\t");
                printf("%s",s);
                }
  
            }

            if(ch=='a')
                break;
```

**菜单栏**

```c

        switch (num+1)
        {
            case 1:
                logup(&count);
                break;

            case 2:
                login();
                break;

            case 3:
                if(pr==NULL)
                    printf("请先登录");
                else
                    showBalance();
                break;

            case 4:
                if(pr==NULL)
                    printf("请先登录");
                else
                    deposit();
                break;

            case 5:
                if(pr==NULL)
                    printf("请先登录");
                else
                    withdraw();         
                break;

            case 6:
                system("cls");
                menu2(); 
                break;

            case 7:
                printf("谢谢使用！\n");
                exit(0);
                break;

            case 8:
                if(pr==NULL)
                    printf("请先登录");
                else
                    transfer();
                break;

            case 9:
                if(pr==NULL)
                    printf("请先登录");
                else changePassword();
                break;

            case 10:
                if(pr==NULL)
                    printf("请先登录");
                else logout();
                break;

            case 11:
                if(pr==NULL)
                    printf("请先登录");
                else email(pr);
                break;

            default:
                printf("请移动到正确位置");
                break;

```

通过在控制台打印相应的信息和使用特定的按键操作方式，实现了一个具有菜单功能的银行ATM系统。用户可以通过向左或向右按键移动菜单选项，按确认键进行选择不同的操作。其中，各个选项对应的操作包括注册、登录、查余额、存款、取款、管理等。具体实现方法为：

- 首先，在菜单开始处进行一些初始化的显示，包括打印欢迎信息和加载完成提示，并改变控制台的颜色。
- 然后，进入一个循环，在循环内部通过按回车键打开菜单，并在屏幕上显示菜单选项。
- 接下来，使用'h'和'l'按键进行左右移动，同时更新菜单的显示位置。
- 当用户按下确认键('a')后，根据当前选择的菜单选项，执行相应的操作。例如，选择注册时调用 `logup()`函数进行用户注册，选择登录时调用 `login()`函数进行用户登录，依此类推。

## 六.课程设计总结

### 1、问题及解决方法

    在ATM系统的设计与实现过程中，我们成功完成了整体规划、界面设计、用户注册与登录、密码加密、存款、取款、转账、改密、余额查询、交易记录查询、管理员系统、用户信息管理、文件操作、延迟显示、删除操作、打印凭据操作、注销、冻结、限额、交易记录等功能。同时，我们也遇到了一些问题：

（1）缓冲区溢出导致scanf输入异常

问题描述：使用scanf函数接收字符输入时，发生了缓冲区溢出，导致输入异常。

问题分析：scanf函数在接收字符时，会将换行符或空格等字符留在缓冲区中，下次调用scanf时会直接从缓冲区读取这些字符，导致输入异常。

解决方案：将scanf的格式字符串修改为" %c"，在%c前加一个空格，这样可以消耗掉缓冲区中的空白字符，确保下次读取的是正确的输入。

（2）静态成员初始化问题

问题描述：在注册过程中，静态成员的初始化出现问题。

问题分析：静态成员在声明时会被初始化为零，但在注册时需要为其赋予相应的值。

解决方案：将静态成员的初始化放在注册过程中，即在注册函数内为静态成员进行赋值操作。

（3）加密函数输入字符串后异常

问题描述：在加密函数中，输入字符串后出现异常情况。

问题分析：在加密函数中，可能忘记在加密后的字符串末尾添加'\0'作为字符串结束的标志。

解决方案：在加密函数的最后添加'\0'，确保加密后的字符串以'\0'结尾。

（4）密码加密输入后无法用backspace撤销

问题描述：在密码输入时，使用backspace键无法撤销已输入的字符。

问题分析：在密码输入时，未对backspace键进行相应的处理。

解决方案：在密码输入的过程中，增加相应的条件语句，当检测到输入为backspace时，可以删除已输入的字符。

（5）冻结账户无法正确匹配到二进制文件

问题描述：冻结账户功能无法正确匹配到相应的二进制文件。

问题分析：在冻结账户功能中，可能存在逻辑错误或者结构体定义不完整的问题。

解决方案：检查冻结账户功能的逻辑，确保正确匹配到相应的二进制文件。如果需要，对结构体进行相应的修改和完善。

（6）锁定密码后再次等待时间结束后未进行任何操作又死循环锁定。

问题分析：在解锁后未添加判断，导致死循环。

解决方案：在解锁后添加判断，避免死循环。

（7）可视化菜单的操作无法对应。

问题分析：switch语句的条件错误。

解决方案：将switch语句的条件改为num+1。

（8）可视化菜单的操作没有限制导致异常。
问题分析：h,l移动时未设置限制。

解决方案：设置h,l移动时的限制。

（9）程序在运行后出现崩溃。
问题分析：结构体数组的宏值过大，导致内存不足。

解决方案：减少结构体数组的宏值，将MAX设置为50。

（10）是否告诉管理员冻结函数异常。
问题分析：逻辑错误，需要改正。

解决方案：修改相关逻辑错误，删掉繁琐的逻辑，在结构体中添加相关信息。

（11）交易记录查询出错。
问题分析：缓冲区异常。

解决方案：处理缓冲区异常问题。

(12)  登录时程序异常

问题分析：结构体变量的指针未赋值造成了野指针。

解决方案：将指针 `pr`指向空。

### 2、模块总体实现情况

我的任务分配为整体规划、界面设计、用户注册与登录、密码加密、存款、取款、转账、改密、余额查询、交易记录查询、管理员系统、用户信息管理、文件操作、延迟显示

后续在次基础上添加了删除操作、打印凭据操作、注销、冻结、限额、交易记录。

经过小组的努力，ATM系统各模块已基本实现，符合课程要求和课题功能。在实际使用过程中，系统运行稳定，功能完善。我们对系统的实现和模块功能进行了充分的测试，确保其符合预期。

### 3、存在问题及改进思路

尽管我们的ATM系统已经实现了许多功能，但仍存在一些问题和不足。

例如：

1. 变量命名可以更清晰一些,比如 pr 可以命名为 currentUser 等。
2. 可以使用更严谨的类型,比如 MAX 可以定义为 const int MAX = 50 等。
3. 可以添加更多的错误处理,比如输入非法字符时的处理等。
4. 可以使用面向对象的编程思想,定义 User、ATM 等类,提高代码复用性和扩展性。
5. 可以添加日志记录功能,记录每次交易信息等。
6. 可以添加安全机制,比如交易次数限制、安全验证码等。
7. 可以分文件编写,比如将用户管理、交易功能等分开,提高程序可维护性。
8. 可以添加计算机网络知识,实现ATM联网、离线交易等功能。
9. 可以进行代码重构,提高程序可读性,比如Extract Method提取方法等。

原因可能包括：技术水平、时间限制、团队合作等。

为了改进系统。我们可以采取以下策略：

1. 继续学习和提高C语言编程能力，以便更好地解决遇到的问题。
2. 优化代码结构，提高代码可读性和可维护性。
3. 加强团队沟通与协作，确保每个成员在项目中发挥最大作用。
4. 在项目初期制定更详细的计划与分工，确保整个开发过程有序进行。

### 4、课程总结

1. 达到了课程的学习目的。通过这个项目,熟练掌握了C语言的基本语法和数据结构,学习了如何设计和实现一个较为复杂的程序。同时也加深了对面向对象编程和软件工程的理解。
2. 学到了许多编程技巧和方法。比如如何设计用户接口,如何实现类和对象,如何进行模块化设计,如何进行错误处理和异常捕捉,如何进行代码重构和重构等。这些技巧和方法对我以后设计和实现程序都非常有帮助。
3. 对C语言程序设计有了更深入的认识。实现这个项目让我了解到C语言除了基本语法之外,还需要掌握数据结构、算法、软件工程等更高级的技能。只有熟练掌握各种工具和技能,才能设计出健壮高效的程序。
4. 对团队合作也有了新的认识。这个项目的大小适合几个人共同完成,让我体会到了团队合作的重要性。通过分工协作,充分发挥每个人的专长,可以更快更好地完成项目。同时,团队中也需要选定一个负责人,统筹进度和质量,妥善解决意见分歧,这也是我的一大收获。
5. 进度管理和计划很重要。为了按时完成这个较大的项目,我们制定了详细的进度计划和时间表,并定期跟进进度,避免出现瓶颈,这些管理经验也可以运用到以后项目中。

    通过这次课程设计，我们对C程序设计有了更深入的了解，学到了许多有关文件操作、结构体、函数等方面的知识。同时，我们也认识到了进度管理、计划与准备、团队合作等方面的重要性。这次课程设计使我们更加明确了自己的不足之处，也为我们提供了一个宝贵的实践机会。在今后的学习和工作中，我们将努力克服不足，不断提高自己的能力，更好地应对各种挑战。

## 七. 建议

作为学习C程序设计和参与ATM模拟系统大作业的学生，我想分享一些关于教学、实验和实践性环节的改进建议，以期提高教学效果和学习体验。

1. 引入更多实践性编程项目：除了ATM模拟系统大作业，将更多的实践性编程项目纳入课程中。这样可以让学生在实际项目中应用所学的知识，加深对C程序设计的理解。例如，可以设计一些简单的小游戏或应用程序，让学生在课程期间逐步完成，从而培养他们的编程技能和解决问题的能力。
2. 设计更具挑战性的大作业：尽管ATM模拟系统是一个不错的项目，但在大作业的设计上可以增加一些更具挑战性的要求。这可以激发学生的学习兴趣和动力，促使他们更深入地研究和应用C程序设计的概念。例如，可以要求学生实现一些高级功能，如多线程处理、数据加密或网络通信等，以提升他们的技术水平和解决实际问题的能力。
3. 提供更多的实验机会：在课程中增加更多的实验环节，让学生通过实际操作来巩固所学的知识。这可以包括编写和调试简单的程序、运行调试工具和观察程序执行过程等。通过这些实验，学生可以更好地理解C程序设计的工作原理，并培养他们的调试能力和错误处理能力。
4. 提供定期的代码评审和反馈：在大作业过程中，定期进行代码评审，并给予详细的反馈。这有助于学生发现和纠正自己代码中的问题，同时学习他人的编程技巧和优秀实践。通过定期的评审和反馈，学生可以不断改进自己的编程风格和质量意识。
5. 引入实际案例和应用场景：将C程序设计与实际案例和应用场景结合起来，可以增加学习的实用性和趣味性。例如，可以引入一些真实的金融系统案例，让学生设计和实现相关功能。这样可以帮助学生将所学的知识与实际问题相联系，加深对C程序设计的理解和应用能力。
6. 采用一些合作办公平台，可以使得小组成员在一个服务器中开发代码，增加工作的连贯性。
